import{r as o}from"./index-D4H_InIO.js";import{c as S}from"./index-DW48STyt.js";import{P as R,u as O,c as le}from"./index-D7-T4lOe.js";import{u as U}from"./index-N3eucVg6.js";import{j as C}from"./jsx-runtime-BO8uF4Og.js";var de="Label",W=o.forwardRef((e,r)=>C.jsx(R.label,{...e,ref:r,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));W.displayName=de;var[q]=le("Form"),G="Form",[ue,P]=q(G),[me,X]=q(G),Y=o.forwardRef((e,r)=>{const{__scopeForm:t,onClearServerErrors:c=()=>{},...a}=e,l=o.useRef(null),v=O(r,l),[d,f]=o.useState({}),u=o.useCallback(n=>d[n],[d]),M=o.useCallback((n,m)=>f(i=>({...i,[n]:{...i[n]??{},...m}})),[]),x=o.useCallback(n=>{f(m=>({...m,[n]:void 0})),s(m=>({...m,[n]:{}}))},[]),[F,E]=o.useState({}),I=o.useCallback(n=>F[n]??[],[F]),p=o.useCallback((n,m)=>{E(i=>({...i,[n]:[...i[n]??[],m]}))},[]),y=o.useCallback((n,m)=>{E(i=>({...i,[n]:(i[n]??[]).filter(g=>g.id!==m)}))},[]),[A,s]=o.useState({}),h=o.useCallback(n=>A[n]??{},[A]),b=o.useCallback((n,m)=>{s(i=>({...i,[n]:{...i[n]??{},...m}}))},[]),[j,_]=o.useState({}),w=o.useCallback((n,m)=>{_(i=>{const g=new Set(i[n]).add(m);return{...i,[n]:g}})},[]),D=o.useCallback((n,m)=>{_(i=>{const g=new Set(i[n]);return g.delete(m),{...i,[n]:g}})},[]),T=o.useCallback(n=>Array.from(j[n]??[]).join(" ")||void 0,[j]);return C.jsx(ue,{scope:t,getFieldValidity:u,onFieldValidityChange:M,getFieldCustomMatcherEntries:I,onFieldCustomMatcherEntryAdd:p,onFieldCustomMatcherEntryRemove:y,getFieldCustomErrors:h,onFieldCustomErrorsChange:b,onFieldValiditionClear:x,children:C.jsx(me,{scope:t,onFieldMessageIdAdd:w,onFieldMessageIdRemove:D,getFieldDescription:T,children:C.jsx(R.form,{...a,ref:v,onInvalid:S(e.onInvalid,n=>{const m=re(n.currentTarget);m===n.target&&m.focus(),n.preventDefault()}),onSubmit:S(e.onSubmit,c,{checkForDefaultPrevented:!1}),onReset:S(e.onReset,c)})})})});Y.displayName=G;var H="FormField",[fe,K]=q(H),Z=o.forwardRef((e,r)=>{const{__scopeForm:t,name:c,serverInvalid:a=!1,...l}=e,d=P(H,t).getFieldValidity(c),f=U();return C.jsx(fe,{scope:t,id:f,name:c,serverInvalid:a,children:C.jsx(R.div,{"data-valid":z(d,a),"data-invalid":J(d,a),...l,ref:r})})});Z.displayName=H;var B="FormLabel",ee=o.forwardRef((e,r)=>{const{__scopeForm:t,...c}=e,a=P(B,t),l=K(B,t),v=c.htmlFor||l.id,d=a.getFieldValidity(l.name);return C.jsx(W,{"data-valid":z(d,l.serverInvalid),"data-invalid":J(d,l.serverInvalid),...c,ref:r,htmlFor:v})});ee.displayName=B;var k="FormControl",te=o.forwardRef((e,r)=>{const{__scopeForm:t,...c}=e,a=P(k,t),l=K(k,t),v=X(k,t),d=o.useRef(null),f=O(r,d),u=c.name||l.name,M=c.id||l.id,x=a.getFieldCustomMatcherEntries(u),{onFieldValidityChange:F,onFieldCustomErrorsChange:E,onFieldValiditionClear:I}=a,p=o.useCallback(async s=>{if(oe(s.validity)){const i=N(s.validity);F(u,i);return}const h=s.form?new FormData(s.form):new FormData,b=[s.value,h],j=[],_=[];x.forEach(i=>{be(i,b)?_.push(i):Ie(i)&&j.push(i)});const w=j.map(({id:i,match:g})=>[i,g(...b)]),D=Object.fromEntries(w),T=Object.values(D).some(Boolean),n=T;s.setCustomValidity(n?V:"");const m=N(s.validity);if(F(u,m),E(u,D),!T&&_.length>0){const i=_.map(({id:ae,match:ie})=>ie(...b).then(ce=>[ae,ce])),g=await Promise.all(i),Q=Object.fromEntries(g),se=Object.values(Q).some(Boolean);s.setCustomValidity(se?V:"");const ne=N(s.validity);F(u,ne),E(u,Q)}},[x,u,E,F]);o.useEffect(()=>{const s=d.current;if(s){const h=()=>p(s);return s.addEventListener("change",h),()=>s.removeEventListener("change",h)}},[p]);const y=o.useCallback(()=>{const s=d.current;s&&(s.setCustomValidity(""),I(u))},[u,I]);o.useEffect(()=>{var h;const s=(h=d.current)==null?void 0:h.form;if(s)return s.addEventListener("reset",y),()=>s.removeEventListener("reset",y)},[y]),o.useEffect(()=>{const s=d.current,h=s==null?void 0:s.closest("form");if(h&&l.serverInvalid){const b=re(h);b===s&&b.focus()}},[l.serverInvalid]);const A=a.getFieldValidity(u);return C.jsx(R.input,{"data-valid":z(A,l.serverInvalid),"data-invalid":J(A,l.serverInvalid),"aria-invalid":l.serverInvalid?!0:void 0,"aria-describedby":v.getFieldDescription(u),title:"",...c,ref:f,id:M,name:u,onInvalid:S(e.onInvalid,s=>{const h=s.currentTarget;p(h)}),onChange:S(e.onChange,s=>{y()})})});te.displayName=k;var V="This value is not valid",ve={badInput:V,patternMismatch:"This value does not match the required pattern",rangeOverflow:"This value is too large",rangeUnderflow:"This value is too small",stepMismatch:"This value does not match the required step",tooLong:"This value is too long",tooShort:"This value is too short",typeMismatch:"This value does not match the required type",valid:void 0,valueMissing:"This value is missing"},L="FormMessage",he=o.forwardRef((e,r)=>{const{match:t,name:c,...a}=e,l=K(L,e.__scopeForm),v=c??l.name;return t===void 0?C.jsx($,{...a,ref:r,name:v,children:e.children||V}):typeof t=="function"?C.jsx(Fe,{match:t,...a,ref:r,name:v}):C.jsx(Ce,{match:t,...a,ref:r,name:v})});he.displayName=L;var Ce=o.forwardRef((e,r)=>{const{match:t,forceMatch:c=!1,name:a,children:l,...v}=e,f=P(L,v.__scopeForm).getFieldValidity(a);return c||(f==null?void 0:f[t])?C.jsx($,{ref:r,...v,name:a,children:l??ve[t]}):null}),Fe=o.forwardRef((e,r)=>{const{match:t,forceMatch:c=!1,name:a,id:l,children:v,...d}=e,f=P(L,d.__scopeForm),u=o.useRef(null),M=O(r,u),x=U(),F=l??x,E=o.useMemo(()=>({id:F,match:t}),[F,t]),{onFieldCustomMatcherEntryAdd:I,onFieldCustomMatcherEntryRemove:p}=f;o.useEffect(()=>(I(a,E),()=>p(a,E.id)),[E,a,I,p]);const y=f.getFieldValidity(a),s=f.getFieldCustomErrors(a)[F];return c||y&&!oe(y)&&s?C.jsx($,{id:F,ref:M,...d,name:a,children:v??V}):null}),$=o.forwardRef((e,r)=>{const{__scopeForm:t,id:c,name:a,...l}=e,v=X(L,t),d=U(),f=c??d,{onFieldMessageIdAdd:u,onFieldMessageIdRemove:M}=v;return o.useEffect(()=>(u(a,f),()=>M(a,f)),[a,f,u,M]),C.jsx(R.span,{id:f,...l,ref:r})}),Ee="FormSubmit",ge=o.forwardRef((e,r)=>{const{__scopeForm:t,...c}=e;return C.jsx(R.button,{type:"submit",...c,ref:r})});ge.displayName=Ee;function N(e){const r={};for(const t in e)r[t]=e[t];return r}function ye(e){return e instanceof HTMLElement}function Me(e){return"validity"in e}function pe(e){return Me(e)&&(e.validity.valid===!1||e.getAttribute("aria-invalid")==="true")}function re(e){const r=e.elements,[t]=Array.from(r).filter(ye).filter(pe);return t}function be(e,r){return e.match.constructor.name==="AsyncFunction"||xe(e.match,r)}function Ie(e){return e.match.constructor.name==="Function"}function xe(e,r){return e(...r)instanceof Promise}function oe(e){let r=!1;for(const t in e){const c=t;if(c!=="valid"&&c!=="customError"&&e[c]){r=!0;break}}return r}function z(e,r){if((e==null?void 0:e.valid)===!0&&!r)return!0}function J(e,r){if((e==null?void 0:e.valid)===!1||r)return!0}var Pe=Y,Le=Z,De=ee,Te=te;export{Te as C,Le as F,De as L,Pe as R};
