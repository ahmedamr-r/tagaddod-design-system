import { Meta, Story, Controls, Canvas, ArgTypes } from '@storybook/blocks';
import * as ModalStories from './Modal.stories';
import { Modal } from './Modal';
import { Button } from '../Button/Button';

<Meta of={ModalStories} />

# Modal Component

The Modal component is a dialog that appears on top of the main content to provide critical information or request user input.

## Overview

Modals are used to focus user attention on a specific task or piece of information without navigating away from the current screen. They're ideal for confirmations, alerts, and short forms.

## Import

```jsx
import { Modal } from '@tagaddod/react';
```

## Props

<ArgTypes of={Modal} />

## Basic Usage

<Canvas of={ModalStories.Default} />

```jsx
import { Modal, Button } from '@tagaddod/react';

<Modal
  trigger={<Button>Open Modal</Button>}
  title="Modal Title"
>
  <div style={{ textAlign: 'center', padding: '16px' }}>
    Modal content goes here
  </div>
</Modal>
```

## Modal Variants

### Default Modal

<Canvas of={ModalStories.Default} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Modal Title"
  showTitle={true}
  showFooter={true}
  cancelLabel="Cancel"
  confirmLabel="Confirm"
  onCancel={() => console.log('Cancelled')}
  onConfirm={() => console.log('Confirmed')}
>
  <div style={{ padding: '16px' }}>
    Modal content goes here
  </div>
</Modal>
```

## Content Padding

The Modal content area has customizable padding using design tokens. The default value is `--t-space-500`.

### Default Content Padding

<Canvas of={ModalStories.Default} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Default Padding"
  // contentPadding="var(--t-space-500)" (default)
>
  <div>
    Content with default padding (--t-space-500)
  </div>
</Modal>
```

### Custom Content Padding

<Canvas of={ModalStories.CustomContentPadding} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Custom Padding"
  contentPadding="var(--t-space-700)"
>
  <div>
    Content with larger padding (--t-space-700)
  </div>
</Modal>
```

### No Content Padding

<Canvas of={ModalStories.NoContentPadding} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="No Padding"
  contentPadding="0"
>
  <div style={{ padding: '16px', backgroundColor: '#f0f0f0' }}>
    Content with no default padding - you can apply your own
  </div>
</Modal>
```

## Width Sizes

The Modal component supports different width sizes to accommodate various content types and use cases.

### Small Width (424px / 26.5rem)

Perfect for simple confirmations and alerts.

<Canvas of={ModalStories.SmallWidth} />

```jsx
<Modal
  width="small"
  trigger={<Button>Open Small Modal</Button>}
  title="Small Modal"
>
  <div style={{ padding: '16px' }}>
    This is a small modal perfect for confirmations.
  </div>
</Modal>
```

### Medium Width (620px / 38.75rem)

The default width, ideal for most modal content.

<Canvas of={ModalStories.MediumWidth} />

```jsx
<Modal
  width="medium"
  trigger={<Button>Open Medium Modal</Button>}
  title="Medium Modal"
>
  <div style={{ padding: '16px' }}>
    This is a medium modal suitable for forms and detailed content.
  </div>
</Modal>
```

### Large Width (980px / 61.25rem)

For complex forms, data tables, or rich content.

<Canvas of={ModalStories.LargeWidth} />

```jsx
<Modal
  width="large"
  trigger={<Button>Open Large Modal</Button>}
  title="Large Modal"
>
  <div style={{ padding: '16px' }}>
    This is a large modal perfect for complex content like forms or data tables.
  </div>
</Modal>
```

### Custom Width

Use custom width with specific dimensions or percentages.

<Canvas of={ModalStories.CustomWidth} />

```jsx
<Modal
  width="custom"
  customWidth="50rem"
  trigger={<Button>Open Custom Width Modal</Button>}
  title="Custom Width Modal"
>
  <div style={{ padding: '16px' }}>
    This modal has a custom width of 50rem.
  </div>
</Modal>
```

### With Min/Max Width Constraints

Control the responsive behavior with minimum and maximum width constraints.

<Canvas of={ModalStories.WithMinMaxWidth} />

```jsx
<Modal
  width="custom"
  customWidth="70%"
  minWidth="20rem"
  maxWidth="60rem"
  trigger={<Button>Open Modal with Min/Max Width</Button>}
  title="Responsive Modal"
>
  <div style={{ padding: '16px' }}>
    This modal has a responsive width of 70% with min/max constraints.
  </div>
</Modal>
```

### Without Title

<Canvas of={ModalStories.WithoutTitle} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  showTitle={false}
  showFooter={true}
  cancelLabel="Cancel"
  confirmLabel="Confirm"
>
  <div style={{ padding: '16px' }}>
    Modal without a title bar
  </div>
</Modal>
```

### Without Footer

<Canvas of={ModalStories.WithoutFooter} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Modal Without Footer"
  showTitle={true}
  showFooter={false}
>
  <div style={{ padding: '16px' }}>
    Modal without action buttons in footer
  </div>
</Modal>
```


## Footer Variants

The Modal component supports three footer variants to handle different use cases and layouts.

### Cancel and Actions Footer

The default variant with a cancel button on the left and action buttons on the right. The cancel button uses a plain variant with neutral tone.

<Canvas of={ModalStories.CancelAndActions} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Cancel & Actions Footer"
  footerVariant="cancelAndActions"
  cancelLabel="Cancel"
  primaryLabel="Save"
  secondaryLabel="Draft"
  showPrimaryButton={true}
  showSecondaryButton={true}
  onCancel={() => console.log('Cancelled')}
  onPrimary={() => console.log('Primary action')}
  onSecondary={() => console.log('Secondary action')}
>
  <div style={{ padding: '16px' }}>
    Modal with cancel button and action buttons
  </div>
</Modal>
```

### Swap Area and Actions Footer

A variant with a customizable swap area on the left and action buttons on the right. Perfect for displaying additional information or controls.

<Canvas of={ModalStories.SwapAndActions} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Swap & Actions Footer"
  footerVariant="swapAndActions"
  primaryLabel="Save"
  secondaryLabel="Draft"
  showPrimaryButton={true}
  showSecondaryButton={true}
  onPrimary={() => console.log('Primary action')}
  onSecondary={() => console.log('Secondary action')}
>
  <div style={{ padding: '16px' }}>
    Modal with swap area and action buttons
  </div>
</Modal>
```

### Actions Only Footer

A minimal variant with only action buttons aligned to the right. No additional elements on the left side.

<Canvas of={ModalStories.ActionsOnly} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Actions Only Footer"
  footerVariant="actionsOnly"
  primaryLabel="Save"
  secondaryLabel="Draft"
  showPrimaryButton={true}
  showSecondaryButton={true}
  onPrimary={() => console.log('Primary action')}
  onSecondary={() => console.log('Secondary action')}
>
  <div style={{ padding: '16px' }}>
    Modal with only action buttons
  </div>
</Modal>
```

### Single Button

You can show or hide individual buttons using the `showPrimaryButton` and `showSecondaryButton` props.

<Canvas of={ModalStories.SingleButton} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Single Button"
  footerVariant="cancelAndActions"
  cancelLabel="Cancel"
  primaryLabel="Save"
  showPrimaryButton={true}
  showSecondaryButton={false}
  onCancel={() => console.log('Cancelled')}
  onPrimary={() => console.log('Primary action')}
>
  <div style={{ padding: '16px' }}>
    Modal with single action button
  </div>
</Modal>
```

### Custom Swap Content

When using the `swapAndActions` variant, you can provide custom content for the swap area.

<Canvas of={ModalStories.CustomSwapContent} />

```jsx
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Custom Swap Content"
  footerVariant="swapAndActions"
  swapContent={<span style={{ color: 'blue', fontWeight: 'bold' }}>Custom Content</span>}
  primaryLabel="Save"
  secondaryLabel="Draft"
  showPrimaryButton={true}
  showSecondaryButton={true}
>
  <div style={{ padding: '16px' }}>
    Modal with custom swap area content
  </div>
</Modal>
```



## Internationalization

The Modal component supports Right-to-Left (RTL) languages with automatic layout reflection for all footer variants:

<Canvas of={ModalStories.RTL} />

```jsx
<Modal
  trigger={<Button>افتح النافذة</Button>}
  title="العنوان"
  rtl={true}
  footerVariant="cancelAndActions"
  cancelLabel="إلغاء"
  primaryLabel="تأكيد"
  secondaryLabel="ثانوي"
>
  <div style={{ padding: '16px', textAlign: 'right' }}>
    هذا هو محتوى النافذة المنبثقة
  </div>
</Modal>
```

### RTL Footer Behavior

In RTL mode, the Modal automatically adjusts footer layouts:

- **Cancel and Actions**: Cancel button moves to the right, actions to the left
- **Swap and Actions**: Swap area moves to the right, actions to the left  
- **Actions Only**: Action buttons align to the left side
- **Button Order**: Within action groups, button order is reversed (primary becomes leftmost)

## Use Cases

### Confirmation Dialog

```jsx
<Modal
  trigger={<Button tone="critical">Delete Item</Button>}
  title="Confirm Deletion"
  cancelLabel="Cancel"
  confirmLabel="Delete"
  onCancel={() => console.log('Cancelled deletion')}
  onConfirm={() => handleDelete()}
>
  <div style={{ padding: '16px' }}>
    Are you sure you want to delete this item? This action cannot be undone.
  </div>
</Modal>
```

### Form Modal

```jsx
function FormModal() {
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');
  
  const handleSubmit = () => {
    // Form submission logic
    console.log({ name, email });
  };
  
  return (
    <Modal
      trigger={<Button>Add User</Button>}
      title="Add New User"
      cancelLabel="Cancel"
      confirmLabel="Save"
      onConfirm={handleSubmit}
    >
      <div style={{ padding: '16px' }}>
        <form>
          <div style={{ marginBottom: '16px' }}>
            <label htmlFor="name">Name</label>
            <input 
              id="name"
              value={name}
              onChange={(e) => setName(e.target.value)}
              style={{ display: 'block', width: '100%', marginTop: '4px', padding: '8px' }}
            />
          </div>
          <div style={{ marginBottom: '16px' }}>
            <label htmlFor="email">Email</label>
            <input 
              id="email"
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              style={{ display: 'block', width: '100%', marginTop: '4px', padding: '8px' }}
            />
          </div>
        </form>
      </div>
    </Modal>
  );
}
```

### Information Display

```jsx
<Modal
  trigger={<Button>View Details</Button>}
  title="User Details"
  showFooter={false}
>
  <div style={{ padding: '16px' }}>
    <h3>John Doe</h3>
    <div>
      <strong>Email:</strong> john.doe@example.com
    </div>
    <div>
      <strong>Role:</strong> Administrator
    </div>
    <div>
      <strong>Joined:</strong> January 15, 2023
    </div>
    
    <div style={{ marginTop: '24px', textAlign: 'right' }}>
      <Button variant="secondary" onClick={() => console.log('Close')}>Close</Button>
    </div>
  </div>
</Modal>
```

## Accessibility

The Modal component follows accessibility best practices:

- Built on Radix UI's Dialog primitive for robust accessibility
- Properly manages focus when opened and closed
- Traps focus within the modal
- Supports keyboard navigation (Tab, Escape)
- Uses proper ARIA roles and attributes
- Correctly handles screen reader announcements
- Supports closing with the Escape key
- Background scroll is prevented when modal is open
- Properly labeled close button

## Implementation Details

### CSS Variables

The Modal component uses the following token CSS variables:

| Variable | Purpose |
|----------|---------|
| `--t-color-overlay` | Background overlay color |
| `--t-color-bg` | Modal background color |
| `--t-color-border` | Border color for header and footer dividers |
| `--t-color-text-primary` | Title and primary text color |
| `--t-color-text-secondary` | Secondary text color |
| `--t-color-bg-hover` | Hover state for close button |
| `--t-border-radius-200` | Border radius |
| `--t-shadow-400` | Shadow for the modal |
| `--t-font-size-headline-sm` | Title font size |
| `--t-font-weight-bold` | Title font weight |
| `--t-line-height-normal` | Line height for text |
| `--t-space-*` | Padding and spacing |
| `--t-z-index-modal` | Z-index for the modal |
| `--t-z-index-modal-overlay` | Z-index for the overlay |
| `--t-modal-width` | Default modal width |

### Architecture

The Modal component is built on Radix UI's Dialog component, which provides:

1. Focus management
2. Keyboard interactions
3. Focus trapping
4. Proper ARIA attributes
5. Animation support

The Tagaddod implementation extends this with:

1. Multiple footer styles
2. Size variants (default and fullscreen)
3. RTL support
4. Customizable header and footer

### Animations

The Modal includes smooth animations for:

1. Overlay fade-in and fade-out
2. Modal scale and fade transitions
3. RTL-specific animations

These animations are disabled when the user prefers reduced motion.

### Browser Support

The Modal component is compatible with all modern browsers and includes RTL language support.
